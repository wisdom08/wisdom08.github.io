---
title: TIL_20200716
permalink: /docs/til_20200716
parent: TIL_202007
grand_parent: TIL
has_children: false
nav_order: 8
---

# Facts

- 서블릿, 서블릿 컨테이너를 공부했고 스트림 관련 메서드도 학습했습니다.
- MVC에 대한 이해도를 높이기 위해서 서블릿/JSP 코드를 뜯어가보면서 공부했습니다.

# Feelings

- 자바 웹 프로그래밍은 정말 어렵네요. 그래도 처음에 공부했을 때보다는 코드에 대한 이해도가 올라가고 있는 것 같아서 기분이 좋습니다. 의식적인 반복의 위대함을 느낍니다.

- 리팩토링이 정말 중요하게 느껴집니다.

# Finding

## 서블릿, 서블릿 컨테이너

- 서블릿: HTTP의 클라이언트 요청과 응답에 대한 표준을 정해 놓은 것
  - 자바 코드로 동적인 웹페이지(HTML)를 만들고 싶다면 서블릿 활용
- 서블릿 컨테이너: 이 서블릿 표준에 대한 구현을 담당하고 있으며 앞에서 구현한 웹 서버가 서블릿 컨테이너 역할과 같다고 생각하면 된다.
  - 서버가 시작할 때 서블릿 인스턴스를 생성해, 요청 URL과 서블릿 인스턴스를 연결해 놓는다.
  - 클라이언트에서 요청이 오면 요청 URL에 해당하는 서블릿을 찾아 서블릿에 모든 작업을 위임한다.
  - 서블릿 컨테이너는 서버를 시작할 때 클래스패스에 있는 클래스 중 HttpServlet을 상속하는 클래스를 찾은 후 @WebServlet 애노테이션의 값을 읽어 요청 URL과 서블릿을 연결하는 Map을 생성한다.
- 즉, 앞에서 구현한 RequestMapping의 Map에 서블릿을 추가하고, 요청 URL에 대한 서블릿을 찾아 서비스하는 역할을 서블릿 컨테이너가 담당한다.
- 서블릿 컨테이너의 중요한 역할 중의 하나는 서블릿 클래스의 인스턴스 생성, 요청 URL과 서블릿 인스터스 매핑, 클라이언트 요청에 해당하는 서블릿을 찾은 후 서블릿에 작업을 위임하는 역할을 한다.
- 이외에도 서블릿 컨테이너는 서블릿과 관련한 초기화와 소멸 작업도 담당한다.
- 서블릿 컨테이너가 생성하는 서블릿 인스턴스의 개수?
  - 서블릿 컨테이너는 멀티스레드로 동작한다.
  - 동시에 여러 명의 클라이언트가 접속할 수 있도록 지원한다.
- 서블릿 컨테이너가 시작할 때 한번 생성되면 모든 스레드가 같은 인스턴스를 재사용한다.

### 서블릿 컨테이너가 시작하고 종료할 때의 과정

- 서블릿 컨테이너 시작
- 클래스 패스에 있는 Servlet 인터페이스를 구현하는 서블릿 클래스를 찾음
- @WebServlet 설정을 통해 요청 URL과 서블릿 매핑
- 서블릿 인스턴스 생성
- init() 메소드를 호출해 초기화
- 서블릿 생성, 초기화, 서비스, 소멸 과정을 거치는 전체 과정을 서블릿의 생명주기라 한다.

### 서블릿 컨테이너의 역할

- 서블릿 컨테이너는 서블릿의 생명주기를 관리한다.
- 이외에도, 멀티스레딩 지원, 설정파일을 활용한 보안관리, JSP 지원 등의 작업을 지원함으로써 개발자가 중요한 비지니스 로직 구현에 집중할 수 있도록 한다.

### 스트림 관련 메서드

- 바이너리 기반 스트림
  - InputStream(입력)
  - OutputStream(출력)
- 텍스트 기반 스트림
  - Reader(입력)
  - Writer(출력)
- 서블릿으로 들어온 요청은 대체로 텍스트(HTML)로 응답을 보낸다.

  ```java
  PrintWriter out =resp.getWriter();
  // 그래서 위 형식의 문장으로
  // 응답으로 내보낼 출력스트림을 얻어낸 후,

  out.println("<script>");
  //이런 식으로 스트렘에 텍스트를 기록하게 된다.
  ```

  ```java
  PrintWriter out =resp.getWriter();
  //응답 스트림에 텍스트를 기록하는 것 => resp.getWrite();

   out.print("Hello World!");
  //파라미터로 설정된 String을 클라이언트에게 보내는 기능(해석기 자체에 보내는 것)
  ```

### JSP

- JSP는 정적인 HTML은 그대로 두고 동적으로 변경되는 부분만 JSP 구문을 활용해 프로그래밍으로 구현하면 된다.
- **RequestDispatcher:** 클라이언트로부터 요청받은 정보를 서버의 다른 자원(HTMl, JSP또는 Servlet등의 자원) 에 **보내는 역할**을 하는 인터페이스
- forward() 메소드 : 클라이언트에서 수행 요청을 받는 Servlet에서 다른 Servlet, JSP 또는 HTML파일등으로 수행 권한을 넘겨서 다른 자원의 수행 결과가 대신 클라이언트로 **응답하는** 기능 지원
